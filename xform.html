<html>
<head>
<title>makemore peaple / doc</title>

<meta property='og:title' content='xform $NOM'>
<meta property='og:description' content='xform $NOM'>
<meta property='og:image' content='https://peaple.io/$NOM.png'>
<meta property='og:image:type' content='image/png'>
<meta property='og:image:width' content='256'>
<meta property='og:image:height' content='256'>
<meta property='og:url' content='https://peaple.io/$NOM/xform'>
<meta property='og:type' content='article'>
<link rel='canonical' href='https://peaple.io/$NOM/xform'>



<script src="/autocomplete.js"></script>
<link rel="stylesheet" type="text/css" href="/autocomplete.css">


<script>

function get_nom() {
  var nom = window.location.pathname;
  nom = nom.substr(1);
  var slash = nom.indexOf('/');
  nom = nom.substr(0, slash);
  return nom;
}

window.nom = get_nom();

function randstr() {
  return "" + Math.floor(Math.random() * 1000000000);
}

function httpget(url, cb) {
  var i = new XMLHttpRequest;
  i.open('GET', url);
  i.overrideMimeType("text/plain");
  i.onload = function(e) {
    if (!(this.readyState == 4 && this.status == 200)) {
      return;
    }
    cb(this.responseText);
  }
  i.send();
}

function reloadpic() {
  piclink.href = "/" + window.nom + "/blend";
  pic.src = "/" + window.nom + ".png" + "?r=" + randstr();
}

function randtag() {
  var pick = function(x) { return x[Math.floor(Math.random() * x.length)] }

  var tags = [
    'human',
    'male',
    'female',
    'white',
    'black',
    'asian',
    'hispanic',
    'blonde_hair',
    'brown_hair',
    'black_hair',
    'gray_hair',
    'bald',

    'mustache',
    'glasses',
    'smiling',
    'old',
    'young',

    'bengal',
    'birman',
    'bombay',
    'maine_coon',
    'persian',
    'ragdoll',
    'british_shorthair',
    'russian_blue',

    'basset_hound',
    'beagle',
    'havanese',
    'keeshond',
    'pomeranian',
    'shiba_inu',
    'yorkshire_terrier'
  ];
  return pick(tags);
}

function pushtags(ntags) {
  var k = ntags.length;

  for (var i = tags.length - k - 1; i >= 0; --i) {
    var ti0 = document.getElementById('tag' + i);
    var ti1 = document.getElementById('tag' + (i + k));
    ti1.src = ti0.src;
    tags[i + k] = tags[i];
  }

  for (var i = 0; i < k; ++i) {
    ntags[i] = (ntags[i] == "") ? randtag() : ntags[i];
    window.tags[i] = ntags[i];
    document.getElementById('tag' + i).src = "/" + ntags[i] + ".png?dev=2&dim=128&r=" + randstr();
  }
}

function make_taglist() {
  var tags = [
    'human',
    'male',
    'female',

    'white',
    'black',
    'asian',
    'hispanic',

    'blonde_hair',
    'brown_hair',
    'black_hair',
    'gray_hair',
    'bald',

    'mustache',
    'glasses',
    'smiling',
    'old',
    'young',

    'bengal',
    'birman',
    'bombay',
    'maine_coon',
    'persian',
    'ragdoll',
    'british_shorthair',
    'russian_blue',

    'basset_hound',
    'beagle',
    'havanese',
    'keeshond',
    'pomeranian',
    'shiba_inu',
    'yorkshire_terrier'
  ];

  window.tags = tags;
  var cols = 4;

  document.write("<table cellpadding=0 cellspacing=0>");
  for (var i = 0; i < tags.length; ++i) {
    if (i % cols == 0) {
      document.write("<tr>");
    }
    document.write(
      "<td id='tagtd" + i + "'>" + 
          "<img width=128 height=128 " + 
            "id='tag" + i + "' " +
            "src='/" + tags[i] + ".png?dev=2&dim=128' " +
            "onClick='addtvec(" + '' + i + '' + ")' " +
          ">" +
      "</td>"
    );
    if (i % cols == cols - 1) {
      document.write("</tr>");
    }
  }

  if (tags.length % cols) {
    document.write("</tr>");
  }

  document.write("</table>");
}

function scramble() {
  httpget("/edit?op=scramble&nom=" + window.nom, function(txt) {
    reloadpic();
  });
}

function tone(mul) {
  httpget("/edit?op=tone&nom=" + window.nom + "&mul=" + mul, function(txt) {
    reloadpic();
  });
}

function addtvec(ti) {
  var vec = window.tags[ti];
  var mul = window.mul;
  if (event.shiftKey)
    mul = -mul;

  httpget("/edit?op=addvec&nom=" + nom + "&vec=" + vec + "&mul=" + mul, function(txt) {
    reloadpic();
  });
}

</script>
</head>

<body text="#ffffff" bgcolor="#000000">

$HEADER

<table width=1280>



  <tr valign="top">
    <td align=center>
<!--
      <input type="button" value="zero" onClick="tone(0)"/>
      <input type="button" value="scramble" onClick="scramble()"/>
      <input type="button" value="uptone" onClick="tone(4.0/3.0)"/>
      <input type="button" value="downtone" onClick="tone(3.0/4.0)"/>
      <br/>
      <br/>
-->

      <div id="picdiv">
        <a id="piclink"><img id="pic" width="512" height="512"></a>
      </div>
       

      <br/>

      <script>reloadpic()</script>
    </td>

    <td align="right">

  <table>
      
<tr><td>
<form autocomplete="off">
  <div class="autocomplete">
    <input type="text" size="32" id="tagbuf" placeholder="nom" style='font-size: large'>
    <script>autocomplete(tagbuf, function() { pushtags([tagbuf.value]) });</script>
  </div>

<!--
    <input type="button" value="pushnom" style="font-size: large" onClick="pushtags([tagbuf.value])">
-->

&nbsp;
    <img align=top width=168 height=24 style="outline: 3px solid blue" src="/images/pushnom.png"
onClick="pushtags([tagbuf.value])" />
</form>
</td></tr>


    <tr>
    <td align="left">
    <script>
      var sw = 512;
      var sh = 40;
      function clickslider() {
        sliderbar.style.width = event.offsetX;
        window.mul = event.offsetX / (sw - 8);
      }
    </script>
    <div id=slidewrap onClick="clickslider()" id="slider" style="border-style: solid; border-width: 4px; border-color: gray">
    <div id="sliderbar" style="background-color: blue"></div>
    <script>
      window.mul = 0.33;
      slidewrap.style.width = sw;
      sliderbar.style.width = window.mul * (sw - 8);
      slidewrap.style.height = sh;
      sliderbar.style.height = sh - 8;
    </script>
    </div>
  </td></tr>


  <tr><td>
      <div style="border-style: solid; border-color: black; border-width: 2">
        <script>make_taglist()</script>
      </div>
  </td></tr>
  </table>

    </td>
  </tr>
</table>

<br/>

<div style="background-color: white" id="json"></div>

<br/>

</body>
</html>
