<html>
<head>
<title>makemore peaple / xform $NOM</title>

<meta property='og:title' content='xform $NOM'>
<meta property='og:description' content='xform $NOM'>
<meta property='og:image' content='https://peaple.io/$NOM.png'>
<meta property='og:image:type' content='image/png'>
<meta property='og:image:width' content='256'>
<meta property='og:image:height' content='256'>
<meta property='og:url' content='https://peaple.io/$NOM/xform'>
<meta property='og:type' content='article'>
<link rel='canonical' href='https://peaple.io/$NOM/xform'>


<script src="/autocomplete.js"></script>
<link rel="stylesheet" type="text/css" href="/autocomplete.css">

<script src="/gennom.js"></script>


<script>

function get_nom() {
  var nom = window.location.pathname;
  nom = nom.substr(1);
  var slash = nom.indexOf('/');
  nom = nom.substr(0, slash);
  return nom;
}

window.nom = get_nom();

function randstr() {
  return "" + Math.floor(Math.random() * 1000000000);
}

function httpget(url, cb) {
  var i = new XMLHttpRequest;
  i.open('GET', url);
  i.overrideMimeType("text/plain");
  i.onload = function(e) {
    if (!(this.readyState == 4 && this.status == 200)) {
      return;
    }
    cb(this.responseText);
  }
  i.send();
}

function reloadpic() {
  piclink.href = "/" + window.nom + "/enc";
  pic.src = "/" + window.nom + ".png" + "?r=" + randstr();
}

function randtag() {
  var pick = function(x) { return x[Math.floor(Math.random() * x.length)] }

  var tags = [
    'human',
    'male',
    'female',
    'white',
    'black',
    'asian',
    'hispanic',
    'blonde_hair',
    'brown_hair',
    'black_hair',
    'gray_hair',
    'bald',

    'mustache',
    'glasses',
    'smiling',
    'old',
    'young',

    'bengal',
    'birman',
    'bombay',
    'maine_coon',
    'persian',
    'ragdoll',
    'british_shorthair',
    'russian_blue',

    'basset_hound',
    'beagle',
    'havanese',
    'keeshond',
    'pomeranian',
    'shiba_inu',
    'yorkshire_terrier'
  ];
  return pick(tags);
}

function pushtags(ntags) {
  var k = ntags.length;

  for (var i = tags.length - k - 1; i >= 0; --i) {
    var ti0 = document.getElementById('tag' + i);
    var ti1 = document.getElementById('tag' + (i + k));
    ti1.src = ti0.src;
    tags[i + k] = tags[i];
  }

  for (var i = 0; i < k; ++i) {
    ntags[i] = (ntags[i] == "") ? gencelebnom() : ntags[i];
    window.tags[i] = ntags[i];
    document.getElementById('tag' + i).src = "/" + ntags[i] + ".png?dev=2&dim=128&r=" + randstr();
  }
}

function pushpals(npals) {
  var k = npals.length;

  for (var i = pals.length - k - 1; i >= 0; --i) {
    var ti0 = document.getElementById('pal' + i);
    var ti1 = document.getElementById('pal' + (i + k));
    ti1.src = ti0.src;
    pals[i + k] = pals[i];
  }

  for (var i = 0; i < k; ++i) {
    npals[i] = (npals[i] == "") ? gencelebnom() : npals[i];
    window.pals[i] = npals[i];
    document.getElementById('pal' + i).src = "/" + npals[i] + ".png?&dim=128&r=" + randstr();
  }
}

function make_pals() {
  var pals = new Array(16);
  for (var i = 0; i < 16; ++i) {
    pals[i] = gencelebnom();
  }

  window.pals = pals;
  var cols = 4;

  document.write("<table cellpadding=0 cellspacing=0>");
  for (var i = 0; i < pals.length; ++i) {
    if (i % cols == 0) {
      document.write("<tr>");
    }
    document.write(
      "<td id='paltd" + i + "'>" + 
          "<img style='cursor: pointer' width=128 height=128 " + 
            "id='pal" + i + "' " +
            "src='/" + pals[i] + ".png?dim=128' " +
            "onClick='addpvec(" + '' + i + '' + ")' " +
          ">" +
      "</td>"
    );
    if (i % cols == cols - 1) {
      document.write("</tr>");
    }
  }

  if (pals.length % cols) {
    document.write("</tr>");
  }

  document.write("</table>");
}

function make_taglist() {
  var tags = [
    'male',
    'female',

    'white',
    'black',
    'asian',
    'hispanic',

    'blonde_hair',
//    'brown_hair',
    'black_hair',
//    'gray_hair',
//    'bald',

    'mustache',
    'glasses',
    'smiling',

//    'old',
//    'young',
    'human',

    'cat',
//    'bengal',
    'birman',
    'persian',
    'british_shorthair',

    'dog',
    'shiba_inu',
//    'havanese',
    'pomeranian',
    'yorkshire_terrier'

//    'bengal',
//    'bombay',
//    'maine_coon',
//    'persian',
//    'ragdoll',
//    'british_shorthair',
//    'russian_blue',

//    'beagle',
//    'keeshond',
  ];

  window.tags = tags;
  var cols = 10;

  document.write("<table cellpadding=0 cellspacing=0>");
  for (var i = 0; i < tags.length; ++i) {
    if (i % cols == 0) {
      document.write("<tr>");
    }
    document.write(
      "<td id='tagtd" + i + "'>" + 
          "<img style='cursor: pointer' width=128 height=128 " + 
            "id='tag" + i + "' " +
            "src='/" + tags[i] + ".png?dev=2&dim=128&cache=86400' " +
            "onClick='addtvec(" + '' + i + '' + ")' " +
          ">" +
      "</td>"
    );
    if (i % cols == cols - 1) {
      document.write("</tr>");
    }
  }

  if (tags.length % cols) {
    document.write("</tr>");
  }

  document.write("</table>");
}

function scramble() {
  httpget("/edit?op=scramble&nom=" + window.nom, function(txt) {
    reloadpic();
  });
}

function tone(mul) {
  httpget("/edit?op=tone&nom=" + window.nom + "&mul=" + mul, function(txt) {
    reloadpic();
  });
}

function warpvar(x) {
  if (x >= 1) {
    return 1e12;
  }
  if (x <= -1) {
    return 1e-12;
  }

  return (x / (1 - x));
}

function unwarpvar(y) {
  return (y / (1 + y));
}

function doaddvec(vec, m) {
  var val = warpvar(window.nval);

  httpget("/edit?op=addvec&nom=" + nom + "&vec=" + vec + "&mul=" + m + "&val=" + val, function(txt) {

   
      window.nval = unwarpvar(txt*1);
      sliderbar2.style.width = window.nval * sw;

    reloadpic();
  });
}

function addvec(vec) {
  doaddvec(vec, window.mul);
}
function subvec(vec) {
  doaddvec(vec, -window.mul);
}

function blendvec(vec) {
  var mul = window.mul;

  httpget("/edit?op=blend&nom=" + nom + "&vec=" + vec + "&mul=" + mul, function(txt) {
   
      window.nval = unwarpvar(txt*1);
      sliderbar2.style.width = window.nval * sw;

    reloadpic();
  });
}

function domash(vec) {
  var mul = window.mul;

  httpget("/edit?op=mash&nom=" + nom + "&vec=" + vec + "&mul=" + mul, function(txt) {

      window.nval = unwarpvar(txt*1);
      sliderbar2.style.width = window.nval * sw;

    reloadpic();
  });
}

function pushrow(who) {
  for (var c = 0; c < 1; ++c) {
    httpget("/new/" + who + ".txt", function(newnom) {
      pushpals([newnom]);
    });
  }
 
//    var tags = window.tags;
//    var ntags = new Array(4);
//    for (var j = 0; j < 4; ++j) {
//      ntags[j] = genfnom() + "_" + who;
//      if (ntags[j].length > 31) { ntags[j] = who; } 
//    }
//    pushpals(ntags);

}

function addtvec(i) {
  if (window.tool == "mash") {
    domash( window.tags[i] );
  } else if (window.tool == "spawn") {
    pushrow( window.tags[i] );
  } else if (window.tool == "map") {
    addvec( window.tags[i] );
  } else if (window.tool == "unmap") {
    subvec( window.tags[i] );
  } else if (window.tool == "goto") {
    window.location = "/" + window.tags[i];
  } else if (window.tool == "blend") {
    blendvec( window.tags[i] );
  } else {
    alert("unimplemented");
  }
}
function addpvec(i) {
  if (window.tool == "mash") {
    domash( window.pals[i] );
  } else if (window.tool == "spawn") {
    pushrow( window.pals[i] );
  } else if (window.tool == "map") {
    addvec( window.pals[i] );
  } else if (window.tool == "unmap") {
    subvec( window.pals[i] );
  } else if (window.tool == "goto") {
    window.location = "/" + window.pals[i];
  } else if (window.tool == "blend") {
    blendvec( window.pals[i] );
  } else {
alert("unimplemented");
  }
}

function donorm() {
  var q = warpvar(window.nval);
  httpget("/edit?op=norm&nom=" + nom + "&val=" + q, function(txt) {
    reloadpic();
  });
}

function onl() {
}
  

</script>
</head>

<body text="#ffffff" bgcolor="#000000" onLoad="onl()">

$HEADER
$SUBHEAD

<table width=1280>



  <tr valign="top">
    <td align=center>

<table>


    <tr>
    <td align="left">
    <script>
      var sw = 512;
      var sh = 40;
      function clickslider() {
        sliderbar.style.width = event.offsetX;
        window.mul = event.offsetX / sw;
      }
    </script>
    <div id=slidewrap onClick="clickslider()" id="slider" style="cursor: pointer; border-style: solid; border-width: 4px; border-color: gray">
    <div id="sliderbar" style="background-color: blue"></div>
    <script>
      window.mul = 0.5;
      slidewrap.style.width = sw;
      sliderbar.style.width = window.mul * sw;
      slidewrap.style.height = sh;
      sliderbar.style.height = sh;
    </script>
    </div>
  </td></tr>

<tr height=8></tr>


    <tr>
    <td align="left">
    <script>
      var sw = 512;
      var sh = 40;
      function clickslider2() {
        sliderbar2.style.width = event.offsetX;
        window.nval = event.offsetX / sw;
        donorm();
      }
    </script>
    <div id=slidewrap2 onClick="clickslider2()" id="slider2" style="cursor: pointer; border-style: solid; border-width: 4px; border-color: gray">
    <div id="sliderbar2" style="width: 0; background-color: orange"></div>
    <script>
      window.nval = unwarpvar($DEV);
      sliderbar2.style.width = window.nval * sw;
      slidewrap2.style.width = sw;
      slidewrap2.style.height = sh;
      sliderbar2.style.height = sh;
    </script>
    </div>
  </td></tr>

<tr height=16></tr>

<!--
      <input type="button" value="zero" onClick="tone(0)"/>
      <input type="button" value="scramble" onClick="scramble()"/>
      <input type="button" value="uptone" onClick="tone(4.0/3.0)"/>
      <input type="button" value="downtone" onClick="tone(3.0/4.0)"/>
      <br/>
      <br/>
-->

<tr><td>
      <div id="picdiv">
        <a id="piclink"><img style="border: 3px solid blue" id="pic" width="512" height="512"></a>
      </div>
</td></tr>

<tr height=16></tr>


</table>
       

      <br/>

      <script>reloadpic()</script>
    </td>


    <td align="right">

<br/>
  <table>
      
<tr><td align="center">
<table><tr><td>

<form autocomplete="off">
  <div class="autocomplete">
    <input type="text" size="32" id="tagbuf" placeholder="nom" style='font-family: monospace; font-size: large'>
    <script>autocomplete(tagbuf, function() { pushpals([tagbuf.value]) });</script>
  </div>

&nbsp;
    <img align=top width=72 height=24 style="outline: 3px solid blue; cursor: pointer" src="/images/add.png"
onClick="pushpals([tagbuf.value])" />
</form>
</td></tr></table>
</td></tr>

<tr><td>
      <div style="border-style: solid; border-color: black; border-width: 2">
        <script>make_pals()</script>
      </div>
</td></tr>




  </table>

    </td>

<td width=168 align=right>
<table>
    <tr>
    <td align=right>

<table>
    <tr><td align=right height="36"><img style="cursor: pointer" width=96 height=24 onClick="clicktool('map')" id="mapbutton" src="/images/more.png"> </td></tr>
    <tr><td align=right height="36"><img style="cursor: pointer" width=96 height=24 onClick="clicktool('unmap')" id="unmapbutton" src="/images/less.png"> </td></tr>
    <tr><td align=right height="36"><img style="cursor: pointer" width=96 height=24 onClick="clicktool('mash')" id="mashbutton" src="/images/mash.png"> </td></tr>
    <tr><td align=right height="36"><img style="cursor: pointer" width=120 height=24 onClick="clicktool('blend')" id="blendbutton" src="/images/blend.png"> </td></tr>
    <tr><td align=right height="36"><img style="cursor: pointer" width=120 height=24 onClick="clicktool('spawn')" id="spawnbutton" src="/images/spawn.png"> </td></tr>
    <tr><td align=right height="36"><img style="cursor: pointer" width=96 height=24 onClick="clicktool('goto')" id="gotobutton" src="/images/goto.png"> </td></tr>
</table>

<script>
function clicktool(t) {
  mapbutton.style.outline = "3px solid blue";
  unmapbutton.style.outline = "3px solid blue";
  mashbutton.style.outline = "3px solid blue";
  blendbutton.style.outline = "3px solid blue";
  spawnbutton.style.outline = "3px solid blue";
  gotobutton.style.outline = "3px solid blue";

  var but = document.getElementById(t + "button");
  but.style.outline = "3px solid #00ff00";
  window.tool = t;
}
clicktool('map');

var shifted = 0;
function shiftdown() {
  if (window.tool == "map") {
    clicktool("unmap");
    shifted = 1;
  }
  //else if (window.tool == "unmap") {
  //  clicktool("map");
  //}
}
function shiftup() {
  //if (window.tool == "map") {
  //  clicktool("unmap");
  //} else
  if (shifted && window.tool == "unmap") {
    clicktool("map");
    shifted = 0;
  }
}
function controldown() {
//  if (window.tool == "map") {
//    clicktool("spawn");
//  }
}
function controlup() {
//  if (window.tool == "spawn") {
//    clicktool("map");
//  }
}

var onkeydown = (function (ev) {
  if (ev.which == 16) {
    shiftdown();
  }
  if (ev.which == 17) {
    controldown();
  }
  if (0 && ev.which == 18) {
    altdown();
  }
});

var onkeyup = (function (ev) {
  if (ev.which == 16) {
    shiftup();
  }
  if (ev.which == 17) {
    controlup();
  }
  if (0 && ev.which == 18) {
    altup();
  }
});

</script>

    </td>
    </tr>
<tr><td height="16"></td></tr>
<tr>
<!--
<td valign="top" height="320" style="outline: 3px solid gray; color: white">
/\/\/\/\/\/\/\/\/\/\/\/\/\/\ <br/>
/\/\/\/\/\/\/\/\/\/\/\/\/\/\  <br/>
/\/\/\/\/\/\/\/\/\/\/\/\/\/\ <br/>
/\/\/\/\/\/\/\/\/\/\/\/\/\/\ <br/>
/\/\/\/\/\/\/\/\/\/\/\/\/\/\ <br/>
/\/\/\/\/\/\/\/\/\/\/\/\/\/\ <br/>
/\/\/\/\/\/\/\/\/\/\/\/\/\/\ <br/>
/\/\/\/\/\/\/\/\/\/\/\/\/\/\ <br/>
/\/\/\/\/\/\/\/\/\/\/\/\/\/\ <br/>
/\/\/\/\/\/\/\/\/\/\/\/\/\/\ <br/>
/\/\/\/\/\/\/\/\/\/\/\/\/\/\ <br/>
/\/\/\/\/\/\/\/\/\/\/\/\/\/\ <br/>
/\/\/\/\/\/\/\/\/\/\/\/\/\/\ <br/>
/\/\/\/\/\/\/\/\/\/\/\/\/\/\ <br/>
/\/\/\/\/\/\/\/\/\/\/\/\/\/\ <br/>
/\/\/\/\/\/\/\/\/\/\/\/\/\/\ <br/>
/\/\/\/\/\/\/\/\/\/\/\/\/\/\ <br/>
/\/\/\/\/\/\/\/\/\/\/\/\/\/\ <br/>
/\/\/\/\/\/\/\/\/\/\/\/\/\/\ <br/>
</td>
-->
</tr>
</table>
</td>
  </tr>


  <tr><td colspan=3>
      <div style="border-style: solid; border-color: black; border-width: 2">
        <script>make_taglist()</script>
      </div>
  </td></tr>

</table>

<br/>

<div style="background-color: white" id="json"></div>

<br/>

</body>
</html>
